<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Network Navigator</title>
	<link rel="stylesheet" href="https://unpkg.com/tachyons@4.12.0/css/tachyons.min.css" />
	<link href="https://emoji-css.afeld.me/emoji.css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.22/b-1.6.5/b-html5-1.6.5/datatables.min.css"/>
	<link rel="stylesheet" type="text/css" href="main.css">
	<link rel="stylesheet" href="css-loader.css">
	<link rel="icon"
		href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ§­</text></svg>">
</head>

<body class="helvetica bg-near-white">
	<div class="loader loader-default"></div>
	<header class="fl w-100 pa3 gradient">
		<nav class="fl w-100 f4 fw6 tracked i white bb">
			<h2 class="retro-font">
				<a class="link white dim" href="/">NETWORK NAVIGATOR</a> <span class="f7 fs-normal">v2.0</span>
			</h2>
			<span class="f5 fr"><a href="/about.html" class="link white dim" target="_blank">About</a></span>
		</nav>
	</header>
	<main class="fl w-100 pa2 flex flex-column">
		<div class="link dim blue pointer" id="show-instructions">Show/Hide Instructions</div>
		<div id="instructions" class="w-80">

			<p>This tool is meant to provide a metrics-focused look into your network data. We hope it will be a quick
				and easy way to get the most popular network measurements. While we provide a small visualization for
				comparison purposes, visualization is not the focus. Instead, we hope the sortable tables will allow you
				to assess and navigate your network in new ways.</p>

			<p>Type or drag-and-drop your edge list into the box below. Use a CSV file or type your edges separated by
				commas, like so (do not include a header row):</p>

			<p>
				<code>Person One,Person Two
					Person Two,Person Three
					Person Three,Person One</code></p>

			<p>Your network can be either weighted or unweighted, and either directed or undirected. If your network is
				weighted, you'll need to add a third column to every line with the weight value:</p>

			<p><code>Person One,Person Two,5</code></p>

			<p>For more information about managing network data and an introduction to the various network metrics used
				here, we recommend two <em>Programming Historian</em> tutorials: <a
					href="https://programminghistorian.org/lessons/creating-network-diagrams-from-historical-sources"
					target="_blank">Creating Network Diagrams from Historical Sources</a> and <a
					href="https://programminghistorian.org/lessons/exploring-and-analyzing-network-data-with-python"
					target="_blank">Exploring and Analyzing Network Data</a>. n.b.: Network Navigator is currently only
				set up for unimodal (or unipartite) networks. While it will give results for any edge list, be advised
				that the metrics for bipartite networks aren't reliable.</p>

			<p><strong>This website does not collect or store <em>any</em> data. Your data remains on your computer
					alone and is not sent to an external server. No one can view your data or results but you.</strong>
			</p>

			<p>If you have comments or suggestions, feel free to <a href="http://twitter.com/johnrladd"
					target="_blank">say hello on Twitter</a>.</p>

		</div>
		<form><!-- onkeydown="event.preventDefault()" -->
			<div class="fl w-100 w-two-thirds-ns pa2">
				<textarea class="db border-box hover-black w-100 h5 ba b--black-20 pa2 br2 mb2"
					placeholder="Paste data from your spreadsheet or drag CSV file here" ></textarea>
			</div>

			<div class="fl w-100 w-third-ns pa2">
				<div class="pa2">
					<input type="radio" value="undirected" name="graphType" id="undirected" checked>
					<label for="undirected">Undirected</label>
					<input type="radio" value="directed" name="graphType" id="directed">
					<label for="directed">Directed</label>
				</div>
				<div class="pa2">
					<input type="radio" value="unweighted" name="graphWeight" id="unweighted" checked>
					<label for="unweighted">Unweighted</label>
					<input type="radio" value="weighted" name="graphWeight" id="weighted">
					<label for="weighted">Weighted</label>
				</div>
				<div class="pa2">
					<input type="checkbox" name="headerRow" id="headerRow">
					<label for="headerRow">Header Row?</label>
				</div>
				<div class="pa2">
					<button class="f6 link dim br3 ph3 pv2 mb2 dib white gradient retro-font pointer" id="calculate" type="button"
						data-loading-text="Calculating..." autocomplete="off">NAVIGATE <i class="em em-compass" aria-role="presentation" aria-label="COMPASS"></i>
					</button>
				</div>
			</div>
		</form>
		</div>
		<div class="alert fl w-100 pa2 br4 ba b--dark-red bg-light-red dark-red" role="alert" id="row-error">
			<p><strong>Too many/too few values!</strong> One or more of the rows in your data has the wrong number of
				values. For unweighted networks, your rows can have two or three values: <code>source,target</code> or
				<code>source,target,weight</code>. For weighted networks, each row must have three values:
				<code>source,target,weight</code>. Please edit your data and try again.</p>
		</div>
		<div class="alert fl w-100 pa2 br4 ba b--gold bg-light-yellow gold" role="alert" id="eigen-error">
			<strong>Skipping Eigenvector Centrality</strong>: Your network has no closed loops, so eigenvector
			centrality cannot be calculated.
		</div>
		<div class="fl w-100 pa2" id="results">
			<div id="buttons" class="w-100 h2">
				<span class="pointer fl" id="metrics-collapse">
					<i class="em em-arrow_left" id="metric-on" aria-role="presentation" aria-label="LEFTWARDS BLACK ARROW"></i>
					<i class="em em-arrow_right" id="metric-off" aria-role="presentation" aria-label="BLACK RIGHTWARDS ARROW"></i>
					<em class="f6">collapse</em> <strong class="retro-font">METRICS</strong>
				</span>
				<span class="pointer fr" id="viz-collapse">
					<strong class="retro-font">VISUALIZATIONS</strong> <em class="f6">collapse</em>
					<i class="em em-arrow_right" id="viz-on" aria-role="presentation" aria-label="BLACK RIGHTWARDS ARROW"></i>
					<i class="em em-arrow_left" id="viz-off" aria-role="presentation" aria-label="LEFTWARDS BLACK ARROW"></i>
			</div>
			<div class="fl w-100 w-50-ns pa2" id="metrics">
				<div class="pa2 flex flex-column relative">
					<div class="pa2 mv2" id="info-panel"></div>
					<div class="w-100 bb b--gray flex-wrap flex">
						<div class="i link dim blue pointer mb3 w-50" id="show-hist"><i class="em em-bar_chart" aria-role="presentation" aria-label="BAR CHART"></i> collapse/expand</div>
						<div class="tr w-50 i link dim pointer mb3" id="download-hist">
							download histogram <i class="em em-floppy_disk" aria-role="presentation" aria-label="FLOPPY DISK"></i>
						</div>
					</div>
					<div class="pa2 ba b--gray br3 mv2" id="hist-container">
					<form id="histType" class="pa2">
						<input type="radio" value="degree" name="histType" id="degree" checked>
						<label for="degree">Degree</label>
						<input type="radio" value="betweenness" name="histType" id="betweenness">
						<label for="betweenness">Betweenness Centrality</label>
						<input type="radio" value="eigenvector" name="histType" id="eigenvector">
						<label for="eigenvector">Eigenvector Centrality</label>
						<input type="radio" value="clustering" name="histType" id="clustering">
						<label for="clustering">Clustering</label>
					</form>
						<svg id="hist"></svg>
						<!-- <div class="fl w-50 h-50" id="degree-hist"></div>
						<div class="fl w-50 h-50" id="betweenness-hist"></div>
						<div class="fl w-50 h-50" id="eigenvector-hist"></div>
						<div class="fl w-50 h-50" id="clustering-hist"></div> -->
					</div>
					<table id="metrics-table" class="display compact nowrap mt2">
						<thead>
							<tr>
								<th>Node ID</th>
								<th>Degree</th>
								<th>Betweenness Centrality</th>
								<th>Eigenvector Centrality</th>
								<th>Clustering Coefficient</th>
							</tr>
						</thead>
						<tbody>
						</tbody>
					</table>
				</div>
			</div>
			<div class="fl w-100 w-50-ns pa2" id="viz">
				<div class="alert pa2 br4 ba b--dark-blue bg-light-blue dark-blue" role="alert" id="viz-warning">
					<strong>Visualization too large</strong>: To protect browser speed, the visualization was not loaded.
					<button class="btn btn-info" type="button" id="load-viz">Click to load</button>
				</div>
				<div class="ba br3 b--gray pa2 flex flex-column relative">
					<div class="fl w-100 flex" id="graph-controls">
						<div class="fl flex w-90-ns w-100 flex-wrap" id="selected-graph">
							<a class="f6 link dim ba ph3 pv2 mb2 dib ma2 w-30-ns w-100 tc gradient white br3 retro-font pointer">Force Layout</a>
							<a class="f6 link dim ba ph3 pv2 mb2 dib ma2 w-30-ns w-100 tc gradient white br3 retro-font pointer">Arc Diagram</a>
							<a class="f6 link dim ba ph3 pv2 mb2 dib ma2 w-30-ns w-100 tc gradient white br3 retro-font pointer">Adjacency Matrix</a>
						</div>
						<div class="fr b--gray br2 ba bg-near-white pa1 ph3 ma2 w-5-ns" id="customize">
							<i class="em em-art" aria-role="presentation" aria-label="ARTIST PALETTE" id="customize-icon"></i>
							<div id="customize-form">
								<div id="force-layout" class="flex flex-column" style="display: none;">
									<h1 class="f6 lh-copy">Customize Force Layout Graph</h1>
									<div class="fl w-100 f6 mid-gray pv2">
										<label for="centrality">Size by centrality:</label>
										<select name="centrality" id="centrality">
											<option value="degree">Degree</option>
											<option value="betweenness">Betweenness</option>
											<option value="eigenvector">Eigenvector</option>
										</select>
									</div>
									<div class="fl w-100 f6 mid-gray pv2">
										<label for="color-picker">Choose a node color:</label>
										<input name="color-picker" id="color-picker" data-jscolor="{onInput:'updateColor(this, &quot;force&quot;)'}" value='08B3E5' />
									</div>
									<div class="fl w-100 f6 mid-gray pv2">
										<label for="edge-weight">Include edge weights?</label>
										<input name="edge-weight" id="edge-weight" type="checkbox" checked />
									</div>
									<div class="fl w-100 f6 mid-gray pv2">
										<input type="radio" value="straight" name="lineType" id="straight" checked>
										<label for="straight">Straight Lines</label>
										<input type="radio" value="curved" name="lineType" id="curved">
										<label for="curved">Curved Lines</label>
									</div>
								</div>
								<div id="arc-diagram" class="flex flex-column" style="display: none;">
									<h1 class="f6 lh-copy">Customize Arc Diagram</h1>
									<div class="fl w-100 f6 mid-gray pv2">
										<label for="centrality-arc">Size by centrality:</label>
										<select name="centrality-arc" id="centrality-arc">
											<option value="degree">Degree</option>
											<option value="betweenness">Betweenness</option>
											<option value="eigenvector">Eigenvector</option>
										</select>
									</div>
									<div class="fl w-100 f6 mid-gray h2">
										<label for="order-arc-nodes">Order nodes:</label>
										<select name="order-arc-nodes" id="order-arc-nodes">
											<option value="original">Original Order</option>
											<option value="name">Name</option>
											<option value="degree">Degree</option>
											<option value="betweenness">Betweenness Centrality</option>
											<option value="eigenvector">Eigenvector Centrality</option>
											<option value="community">Community</option>
										</select>
									</div>
									<div class="fl w-100 f6 mid-gray pv2">
										<label for="color-picker-arc">Choose a node color:</label>
										<input name="color-picker-arc" id="color-picker-arc" data-jscolor="{onInput:'updateColor(this, &quot;arc&quot;)'}" value='08B3E5' />
									</div>
									<div class="fl w-100 f6 mid-gray h2">
										<label for="reverse-arc-order">Reverse order?</label>
										<input name="reverse-arc-order" id="reverse-arc-order" type="checkbox" />
									</div>
									<div class="fl w-100 f6 mid-gray h2">
										<input type="radio" value="horizontal" name="graphDirection" id="horizontal">
										<label for="horizontal">Horizontal Arc Diagram</label>
										<input type="radio" value="vertical" name="graphDirection" id="vertical" checked>
										<label for="vertical">Vertical Arc Diagram</label>
									</div>
								</div>
								<div id="adjacency-matrix" class="flex flex-column" style="display: none;">
									<h1 class="f6 lh-copy">Customize Matrix</h1>
									<div class="fl w-100 f6 mid-gray h2">
										<label for="order-matrix-cells">Order Cells:</label>
										<select name="order-matrix-cells" id="order-matrix-cells">
											<option value="original">Original Order</option>
											<option value="name">Name</option>
											<option value="degree">Degree</option>
											<option value="betweenness">Betweenness Centrality</option>
											<option value="eigenvector">Eigenvector Centrality</option>
											<option value="community">Community</option>
										</select>
									</div>
									<div class="fl w-100 f6 mid-gray pv2">
										<label for="color-picker-matrix">Choose a node color:</label>
										<input name="color-picker-matrix" id="color-picker-matrix"
											data-jscolor="{onInput:'updateColor(this, &quot;matrix&quot;)', format: 'rgb'}" value='08B3E5' />
									</div>
									<div class="fl w-100 f6 mid-gray h2">
										<label for="reverse-matrix-order">Reverse order?</label>
										<input name="reverse-matrix-order" id="reverse-matrix-order" type="checkbox" />
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="fl w-100 flex">
						<div id="force-layout-viz"></div>
						<div id="arc-diagram-viz" style="visibility: hidden;" ></div>
						<div id="matrix-viz" style="visibility: hidden;"></div>
					</div>
					<div class="fl w-100 flex">
						<a id="download-graph" class="f6 link dim ba ph3 pv2 mb2 dib mid-gray ma2 w-40 tc br3 pointer">Download Graph <i
								class="em em-floppy_disk" aria-role="presentation" aria-label="FLOPPY DISK"></i></a>
						<a id="restore-zoom" class="f6 link dim ba ph3 pv2 mb2 dib mid-gray ma2 w-40 tc br3 pointer">Restore Zoom <i class="em em-dart" aria-role="presentation" aria-label="DIRECT HIT"></i>
						</a>
					</div>
				</div>
			</div>
		</div>
	</main>

	<!-- Latest jQuery API -->
	<script src="https://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>

	<script type="text/javascript" src="https://d3js.org/d3.v4.min.js"></script>
	<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.6/d3-legend.min.js"></script>
	<script type='text/javascript' src='js/jsnetworkx.js'></script>
	<script type="text/javascript" src="js/jquery.csv.min.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.22/b-1.6.5/b-html5-1.6.5/datatables.min.js"></script>
	</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jscolor/2.4.2/jscolor.min.js"></script>
	<script>
	    function updateColor(picker, type) {
		if (type === 'force') {
	            d3.selectAll('.node').attr('fill', picker.toString());
		} else if (type === 'arc') {
	            d3.selectAll('.node-arc').attr('fill', picker.toString());
		} else if (type === 'matrix') {
		    var origColor = picker.toString().replace(/[rgb\(\)]/gm, "").split(",");
	            var newColor = origColor.map(c => { return Math.round((255-c)*0.8+parseInt(c))});
		    var newRGB = `rgb(${newColor.join(",")})`;
		    var colorValues = d3.selectAll('.matrix-cell').data().map(d => d.weight);
		    var color = d3.scaleLinear()
                        .domain([d3.min(colorValues), d3.max(colorValues)])
                        .range([newRGB,picker.toString()])
		    d3.selectAll('.matrix-cell').style('fill', (d) => {if (d.weight===0) {return 'white';} else {return color(d.weight)} })
		    var colorUniques = [...new Set(colorValues)].sort((a,b) => {return a-b;});
		    var legendLinear = d3.legendColor()
                          .shapeWidth(50)
                          .cells(colorUniques.slice(1))
                          .scale(color)
                          .labelOffset(40);
                      
                    d3.select(".legendLinear")
                          .call(legendLinear);

		}
            }

            jscolor.trigger('input');
	</script>

	<script type='module' src='js/main.js'></script>

</body>

</html>
